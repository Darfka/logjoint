<format>
  <regular-grammar>
<extensions>
  <extension name="sysinternals" class-name="LogJoint.SysinternalsFormats.Extension, Sysinternals.plugin"/>
</extensions>
	  <head-re><![CDATA[^
\"(?<time>[^\"]+)\"\,
\"(?<proc>[^\"]+)\"\,
\"(?<pid>\d+)\"\,
\"(?<op>[^\"]+)\"\,
\"(?<path>[^\"]*)\"\,
\"(?<res>[^\"]+)\"\,
\"(?<details>[^\"]*)\"]]></head-re>
    <body-re><![CDATA[]]></body-re>
    <fields-config>
      <field name="Body" code-type="function"><![CDATA[StringBuilder ret = new StringBuilder();
ret.AppendFormat("{0} ({1}) {2}=>{3} {4}", proc, pid, op, res, path);
ret.AppendFormat("{0}----- Details: -----{0}{1}", Environment.NewLine, details);
return ret.ToString();
]]></field>
      <field name="Time"><![CDATA[sysinternals.PARSE_XML_TIME_OF_DAY(time)]]></field>
    </fields-config>
    <patterns>
      <pattern>*.csv</pattern>
    </patterns>
    <encoding>BOM</encoding>
  </regular-grammar>
  <id company="Sysinternals" name="procmon CSV" />
  <description>Reads CSV logs created by Sysinternals Process Monitor (procmon.exe) tool.</description>
</format>