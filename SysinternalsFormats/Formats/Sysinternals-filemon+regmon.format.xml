<format>
  <regular-grammar>
    <extensions>
      <extension name="sysinternals" class-name="LogJoint.SysinternalsFormats.Extension, Sysinternals.plugin"/>
    </extensions>
    <head-re><![CDATA[^
(?<msgNum>\d+)\t
(?<time>.+?)\t
(?<pName>.+?)\:
(?<pid>\d+)\t
(?<op>.+?)\t
(?<fName>.+?)\t
(?<res>.+?)\t
]]></head-re>
    <body-re><![CDATA[^(?<details>.*?)\s*$]]></body-re>
    <fields-config>
      <field name="Body"><![CDATA[string.Format("{0} {1} ({2}) {3}=>{4} {5} {6}", msgNum, pName, pid, op, res, fName, details)]]></field>
      <field name="Time"><![CDATA[sysinternals.PARSE_FILEMON_TIME(time)]]></field>
      <field name="Severity"><![CDATA[res == "SUCCESS" ? Severity.Info : Severity.Warning]]></field>
    </fields-config>
    <patterns>
      <pattern>*.log</pattern>
    </patterns>
    <encoding>BOM</encoding>
  </regular-grammar>
  <id company="Sysinternals" name="filemon+regmon log" />
  <description>Reads text logs created by Sysinternals File Monitor (filemon.exe) or Registry Monitor (regmon.exe) tools. Logs saved without clock time are not supported.</description>
</format>