<format>
  <regular-grammar>
    <head-re><![CDATA[^
(?<ClientIP>[\d\.]+)\,\  # Client IP (v4 or v6)
(?<UserName>.+|\-)\,\  # User Name
(?<M>\d{1,2})\/(?<D>\d{1,2})\/(?<Y>\d+)\,\   # Date
(?<H>\d{1,2})\:(?<m>\d{1,2})\:(?<S>\d{1,2})\,\  # Time
(?<Service>\w+|\-)\,\  # Service and instance
(?<Server>\w+|\-)\,\  # Server name
(?<ServerIP>[\d\.]+)\,\  # Server IP (v4 or v6)
(?<TimeTaken>\d+|\-)\,\  # Time taken
(?<ClientBytes>\d+|\-)\,\  # Client bytes sent
(?<ServerBytes>\d+|\-)\,\  # Server bytes sent
(?<ServiceStatus>\d+|\-),\  # Service status code
(?<WindowsStatus>\d+|\-),\  # Windows status code
(?<Request>.+?|\-)\,\  # Request type
(?<Target>.+?|\-)\,\  # Target of operation
(?<Params>.+?|\-)\,  # The parameters that are passed to a script]]></head-re>
    <fields-config>
      <field name="Time"><![CDATA[new DateTime(PARSE_YEAR(Y), TO_INT(M), TO_INT(D), TO_INT(H), TO_INT(m), TO_INT(S))]]></field>
      <field name="Body" code-type="function"><![CDATA[StringBuilder ret = new StringBuilder();
for (int i = 0; i < INPUT_FIELDS_COUNT(); ++i) 
{
	string value = INPUT_FIELD_VALUE(i).Value;
	string name = INPUT_FIELD_NAME(i);
	if (name.Length == 1) // DateTime realetd captures (M, D, Y, H, m, S)
		continue;
	if (value == "-") // no-value string (-)
		continue;
	if (ret.Length > 0)
		ret.Append(", ");
	ret.AppendFormat("{0}={1}", name, value);
}
return new StringSlice(ret.ToString());]]></field>
      <field name="Severity"><![CDATA[ServiceStatusString == "200" ? Severity.Info : Severity.Warning]]></field>
    </fields-config>
    <patterns />
    <encoding>ACP</encoding>
  </regular-grammar>
  <id company="Microsoft" name="IIS" />
  <description>IIS log files in the Microsoft IIS Log File Format.</description>
</format>